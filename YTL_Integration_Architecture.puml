@startuml YTL_Integration_Architecture
title YTL Cement - Integration Architecture (Middleware & APIs)
skinparam backgroundColor #F5F5F5

rectangle "SYNCHRONOUS INTEGRATIONS\n(Real-time, Guaranteed Delivery)" as sync #FFE6E6 {
  component [S/4HANA\nPO/STO] as s4_po
  component [SAP PI/XI\nMessage Queue] as pi_sync
  component [Weighbridge\n(102 - GR)] as wb_sync
}

note right of sync
  **SLA: <5 seconds per transaction**
  Error handling: Retry x3, escalate to queue
  Use case: Purchase orders, goods receipts
end note

rectangle "ASYNCHRONOUS INTEGRATIONS\n(Batch/Event-Driven)" as async #E6F3FF {
  component [S/4HANA GL\nModule] as s4_gl
  component [Message Bus\n(Event Topic)] as event_bus
  component [Invoice\nMatching MVP] as async_invoice
  component [GL Anomaly\nMVP] as async_gl
  component [Vendor Quality\nMVP] as async_vendor
  component [SoD Analyzer\nMVP] as async_sod
  component [S/4HANA AP\nModule] as s4_ap
  component [S/4HANA Vendor\nMaster] as s4_vendor
}

note right of async
  **SLA: <10 minutes per batch**
  Error handling: Retry x5, DLQ (dead letter queue)
  Use cases: Continuous monitoring, anomaly detection
end note

rectangle "API INTEGRATIONS\n(External Partners & Portals)" as api #FFFFCC {
  component [S/4HANA\nAPI Gateway] as api_gw

  rectangle "Vendor Portal APIs" as vendor_api {
    component [Submit RFQ] as rfq_api
    component [Check PO Status] as po_status_api
    component [View Invoices] as inv_status_api
  }

  rectangle "Customer Portal APIs" as customer_api {
    component [Order Tracking] as order_track_api
    component [Invoice Download] as inv_down_api
    component [Payment Status] as pay_status_api
  }

  rectangle "External Partner APIs" as partner_api {
    component [LHDN MyInvois\n(e-Invoice)] as lhdn_api
    component [Bank APIs\n(Payments)] as bank_api
    component [DCS/Plant\nSystems] as dcs_api
  }

}

note right of api
  **SLA: <2 seconds per request**
  Security: OAuth2, encrypted payloads, IP whitelisting
  Error handling: Retry x3, fallback to batch
  Rate limiting: 100 req/sec per partner
end note

rectangle "DATA WAREHOUSE INTEGRATION\n(Analytics & Reporting)" as dw_int #CCFFCC {
  component [S/4HANA\nCDC] as cdc
  component [Real-time\nReplication] as repl
  component [Data Warehouse\n(Hadoop/Spark)] as dw
  component [BI Tools\n(Looker/Tableau)] as bi

}

note right of dw_int
  **SLA: <1 hour data freshness**
  Fact tables: Transactions
  Dimension tables: Master data
  Aggregated views: Analytics models
end note

rectangle "BACKUP & ARCHIVE INTEGRATION" as backup #FFCCCC {
  component [S/4HANA\nProduction] as prod
  component [Backup\nSystem] as backup_sys
  component [Archive\nStorage] as archive

}

note right of backup
  **RPO: 1 hour**
  **RTO: 4 hours**
  Retention: Daily (30 days), Monthly (1 year)
end note

@enduml
